# Handwriting Personality Prediction
This project develops deep learning models to predict the “Big Five” personality traits (Agreeableness, Conscientiousness, Extraversion, Neuroticism, Openness) using handwriting images. We explore two main approaches: a Convolutional Neural Network (CNN) trained from scratch and a Transfer Learning approach utilizing a pre-trained ResNet model. Our weight and report are in : [google drive](https://drive.google.com/drive/folders/15rN2wU2jW00ZsWvquwiO0VUGMC1KLgou?usp=sharing)

# Project Structure
    .
    ├── cnn.py                          # Code for training and evaluating the custom CNN model
    ├── cnn_transfer.py                 # Code for training and evaluating the transfer learning (ResNet50) model
    ├── personality_cnn.pt              # Trained weights of the custom CNN model (example)
    ├── personality_transfer_learning.pt # Trained weights of the transfer learning model (example)
    ├── loss_curve_cnn.png              # Training/validation loss graph for the CNN model
    ├── accuracy_curve_cnn.png          # Validation accuracy graph for the CNN model (to be generated by cnn.py)
    ├── confusion_matrix_cnn.png        # Confusion matrix for the CNN model
    ├── loss_curve_transfer_learning.png  # Training/validation loss graph for the transfer learning model (to be generated by cnn_transfer.py)
    ├── accuracy_curve_transfer_learning.png # Validation accuracy graph for the transfer learning model (to be generated by cnn_transfer.py)
    ├── confusion_matrix_transfer_learning.png # Confusion matrix for the transfer learning model (to be generated by cnn_transfer.py)
    └── README.md                       # This README file

# Dataset
This dataset is sourced from Kaggle : [Handwriting based personality detection](https://www.kaggle.com/datasets/vuppalaadithyasairam/handwriting-based-personality-detection/data)
This project uses a handwriting image dataset where each image is labeled with one of the Big Five personality traits: Agreeableness, Conscientiousness, Extraversion, Neuroticism, and Openness. The dataset is assumed to be located at:

`/Users/douyoung/Library/CloudStorage/GoogleDrive-douyoung@gmail.com/내 드라이브/1. 고려대학교/4학년/1학기/데이터과학/archive-2/augmented train`

`/Users/douyoung/Library/CloudStorage/GoogleDrive-douyoung@gmail.com/내 드라이브/1. 고려대학교/4학년/1학기/데이터과학/archive-2/augmented test`

## Data Preprocessing

Before training, the raw dataset underwent specific preprocessing steps using the provided Python scripts to ensure a proper hierarchical structure for group-based data splitting.

1. `preprocess.py` (Initial Reorganization):

This script reorganizes image files into subfolders based on their original group ID, extracted from filenames.

For example, files like `authorname-essayid-augnum.png` (e.g., `anuraggupta19eng-1-1.png`) are moved into a folder named `authorname-essayid` (e.g., `anuraggupta19eng-1`).

This creates an initial structure where augmented images from the same original essay are grouped.

2. `preprocess2.py` (Folder Consolidation):

This script further consolidates the folders created by preprocess.py.

If group IDs are structured like `nameX-Y` (e.g., `authorname-essayid`), this script moves all files from such folders into a higher-level folder named `nameX` (e.g., `authorname`).

This ensures that all essays from the same author are grouped under one primary folder, facilitating robust individual-level data splitting.


## Data Structure Example:

    <root_dir>/
    ├── Agreeableness/
    │   ├── nameA/    # original_id_group folder (group_id)
    │   │   ├── img1.png
    │   │   └── ...
    │   └── ...
    └── Conscientiousness/
        ├── nameC/
        │   └── ...
        └── ...

The dataset is split into training, validation, and test sets at the individual (group_id) level (e.g., nameA) to prevent data leakage.

# Models
## 1. Custom CNN (PersonalClassifier in cnn.py)

This is a Convolutional Neural Network model trained from scratch.

### Architecture:

Two convolutional layers with ReLU activation and MaxPool2d layers.

nn.AdaptiveAvgPool2d((1, 1)) to flatten features.

Classifier with two linear layers, ReLU, and Dropout.

### Hyperparameters:

Input Channels: 3 (RGB images)

Output Classes: 5

Dropout: 0.2

Optimizer: optim.Adam

Learning Rate: 0.001

Loss Function: nn.CrossEntropyLoss

Batch Size: 32

Epochs: 50

Early Stopping: Stop if validation loss does not improve for 7 epochs.

## 2. Transfer Learning Model (TransferLearningModel in cnn_transfer.py)

This model utilizes a pre-trained ResNet18, ResNet34, ResNet50 for transfer learning.

### Architecture

Load pre-trained ResNet50 from torchvision.models.

Freeze most ResNet parameters.

Replace the final FC layer with:

    nn.Sequential(
        nn.Dropout(0.3),
        nn.Linear(num_ftrs, num_ftrs),
        nn.GELU(),
        nn.Dropout(0.3),
        nn.Linear(num_ftrs, num_classes)
    )

### Hyperparameter

Output Classes: 5

Optimizer: optim.Adam (only FC layer parameters)

Learning Rate: 0.001

Loss Function: nn.CrossEntropyLoss

Batch Size: 32

Epochs: 20

Early Stopping: Stop if validation loss does not improve for 5 epochs.

# How to Run
## 1. Install Dependencies

    conda env create -f environment.yml

## 2.Prepare Dataset

Ensure your handwriting dataset matches the PersonalityDataset structure in the scripts.

Update paths (root_dir and test_csv) in cnn.py and cnn_transfer.py.

## 3. Train and Evaluate

**- Custom CNN**

    python cnn.py

**- Transfer Learning Model**

    python cnn_transfer.py

Upon completion, loss/accuracy graphs, confusion matrices, and classification reports will be saved as .png and .json files.

# Analysis of Results (Brief Reasons for Low Accuracy)
## Inherent Task Difficulty
Predicting abstract traits from handwriting lacks clear, consistent visual patterns that are easily discernible by machine learning models.

## Data Limitations

**Feature Extraction Challenge**: Subtle handwriting features (e.g., slant, pressure, stroke characteristics) that might correlate with personality are inherently hard for CNNs to robustly capture and generalize from.

**Quantity & Diversity**: The dataset size and diversity may be insufficient for training deep learning models to generalize effectively across a wide range of handwriting styles.

**Label Noise**: Personality labels, especially if derived from self-reports, may contain inherent subjectivity and noise, making it difficult for the model to learn a perfect mapping.

## Model Expressiveness and Suitability

**Custom CNN**: The custom CNN's shallow architecture might lack the capacity to learn the complex, high-level features necessary for handwriting personality analysis.

**Transfer Learning**: Pre-training on ImageNet (for object recognition) may not adequately prepare the ResNet model for the unique patterns found in handwriting images, limiting the effectiveness of transfer learning for this specific task.

## Training Optimization
The observed low training accuracy suggests that the models might not be learning effectively from the data, even during the training phase. Further hyperparameter tuning, architectural modifications, or specialized pre-processing techniques for handwriting (beyond standard image augmentation) may be needed.
